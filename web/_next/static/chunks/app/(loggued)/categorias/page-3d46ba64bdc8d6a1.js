(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[670],{3830:function(e,t,a){Promise.resolve().then(a.bind(a,8932))},5853:function(e,t,a){"use strict";var l=a(9018),n=a(7437);t.Z=(0,l.Z)((0,n.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM8 9h8v10H8zm7.5-5-1-1h-5l-1 1H5v2h14V4z"}),"DeleteOutline")},606:function(e,t,a){"use strict";a.d(t,{H:function(){return c},a:function(){return u}});var l=a(7437),n=a(2265),i=a(8254),r=a(2649),s=a(6463),o=a(5041);let d=(0,n.createContext)(null),c=e=>{let{children:t}=e,[a,c]=(0,n.useState)(null),u=(0,s.useRouter)(),v=()=>{let e=r.Z.get("token");e&&i.Z.get("/api/getuser",{headers:{Authorization:"Bearer ".concat(e)}}).then(e=>c(e.data.data)).catch(()=>r.Z.remove("token"))};(0,n.useEffect)(()=>{v()},[]);let h=async(e,t,a)=>{var l,n,s;try{let n=await i.Z.post("/api/login",{username:e,password:t});n.data.token&&(r.Z.set("token",n.data.token,{expires:1}),c(n.data.user),(0,o.yv)(null==n?void 0:null===(l=n.data)||void 0===l?void 0:l.message,{variant:"success"}),a&&setTimeout(()=>{v(),u.push(a)},500))}catch(e){console.log(e),(0,o.yv)(null==e?void 0:null===(s=e.response)||void 0===s?void 0:null===(n=s.data)||void 0===n?void 0:n.message,{variant:"error"})}};return(0,l.jsx)(d.Provider,{value:{isAuthenticated:!!a,user:a,login:h,logout:()=>{r.Z.remove("token"),c(null),u.refresh()}},children:t})},u=()=>(0,n.useContext)(d)},7150:function(e,t,a){"use strict";a.d(t,{b:function(){return s}});var l=a(2265),n=a(9039),i=a(8254),r=a(5041);let s=()=>{let[e,t]=(0,l.useState)([]),[a,s]=(0,l.useState)(!1),o=async()=>{s(!0);let e=await i.Z.get("/api/categories"),t=e.data;if(s(!1),200===e.status)return t;{let a=Error(t.message);throw a.info=t,a.status=e.status,a}},{data:d,error:c,isLoading:u,mutate:v}=(0,n.ZP)("/api/categories",o,{onErrorRetry:e=>{if(403===e.status)return}});return(0,l.useEffect)(()=>{t(d||[])},[d]),{getAllCategories:o,updateCategory:async e=>{var t,a,l;try{let a=await i.Z.put("/api/category",{...e});return(0,r.yv)(null==a?void 0:null===(t=a.data)||void 0===t?void 0:t.message,{variant:"success"}),v(),a}catch(e){(0,r.yv)(null==e?void 0:null===(l=e.response)||void 0===l?void 0:null===(a=l.data)||void 0===a?void 0:a.message,{variant:"error"})}},deleteCategory:async e=>{var t,a,l;try{let a=await i.Z.delete("/api/category",{data:{id:e}});return(0,r.yv)(null==a?void 0:null===(t=a.data)||void 0===t?void 0:t.message,{variant:"success"}),v(),a}catch(e){(0,r.yv)(null==e?void 0:null===(l=e.response)||void 0===l?void 0:null===(a=l.data)||void 0===a?void 0:a.message,{variant:"error"})}},categoriesList:e,addCategory:async e=>{var t,a,l;s(!0);try{let a=await i.Z.post("/api/category",{...e});return(0,r.yv)(null==a?void 0:null===(t=a.data)||void 0===t?void 0:t.message,{variant:"success"}),v(),a}catch(e){(0,r.yv)(null==e?void 0:null===(l=e.response)||void 0===l?void 0:null===(a=l.data)||void 0===a?void 0:a.message,{variant:"error"})}finally{s(!1)}},isLoading:u,loading:a}}},8932:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return g}});var l=a(7437),n=a(7150),i=a(2265),r=a(9018),s=(0,r.Z)((0,l.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm2 16H5V5h11.17L19 7.83zm-7-7c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3M6 6h9v4H6z"}),"SaveOutlined"),o=a(6374),d=a(5853),c=(0,r.Z)((0,l.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add"),u=a(3983),v=a(335),h=a(1777),x=e=>{let{categories:t,setCategories:a}=e,{updateCategory:r,deleteCategory:x,addCategory:f}=(0,n.b)(),m=(0,h.N4)(),p=e=>{var n,h,g;let{data:j,nivel:y}=e,[Z,w]=(0,i.useState)(!1),[k,C]=(0,i.useState)({});(0,i.useEffect)(()=>{C(j)},[]);let b=async()=>{(null==j?void 0:j.Mode)==="Add"?await f(k):await r(k)},N=async()=>{m({title:"Eliminar categor\xeda",description:"\xbfDesea eliminar la categor\xeda? Se eliminar\xe1n las cateogrias hijo tambi\xe9n",confirmationText:"Eliminar",cancellationText:"Cancelar",cancellationButtonProps:{color:"error"}}).then(async()=>{await x(null==k?void 0:k.id)})};return(0,l.jsxs)("div",{className:" flex w-full text-xs   items-start font-light text-zinc-100 ",children:[(0,l.jsxs)("div",{className:"flex",children:[(0,l.jsxs)("span",{className:"flex items-center px-2  min-w-[130px] justify-between ",children:[Z||(null==j?void 0:j.Mode)==="Add"?(0,l.jsx)(u.Z,{variant:"standard",size:"small",value:null==k?void 0:k.name,onChange:e=>C(t=>({...t,name:e.target.value}))}):(0,l.jsx)("p",{children:null==j?void 0:j.name}),Z||(null==j?void 0:j.Mode)==="Add"?(0,l.jsxs)(v.Z,{onClick:()=>{C(j),b()},children:[" ",(0,l.jsx)(s,{color:"success"})]}):(0,l.jsxs)(v.Z,{onClick:()=>{C(j),w(!Z)},children:[" ",(0,l.jsx)(o.Z,{})]}),Z&&(0,l.jsx)(v.Z,{color:"error",onClick:N,children:(0,l.jsx)(d.Z,{})})]}),(null==j?void 0:j.id)&&(0,l.jsx)("div",{className:"flex justify-start",children:(0,l.jsx)(v.Z,{onClick:()=>{let e=[...t],l=y.split("-").map(Number),n=e;for(let e=0;e<l.length-1;e++)console.log(n=n[l[e]].children);let i=n[l[l.length-1]];(null==i?void 0:i.children)||(i.children=[]),i.children.push({name:"",Mode:"Add",children:[],parent_id:null==i?void 0:i.id}),a(e)},children:(0,l.jsx)(c,{})})})]}),(0,l.jsx)("div",{children:(null==j?void 0:null===(n=j.children)||void 0===n?void 0:n.length)===1?(0,l.jsx)(p,{data:null==j?void 0:j.children[0],nivel:"".concat(y,"-0")}):(null==j?void 0:null===(h=j.children)||void 0===h?void 0:h.length)>1&&(0,l.jsx)("div",{children:null==j?void 0:null===(g=j.children)||void 0===g?void 0:g.map((e,t)=>(0,l.jsx)(p,{data:e,nivel:"".concat(y,"-").concat(t)}))})})]})};return(0,l.jsxs)("div",{className:" flex flex-col gap-4 efecto-vidrio p-4 max-w-[60vw] overflow-auto text-sm",children:[null==t?void 0:t.map((e,t)=>(0,l.jsx)("span",{className:" border-b border-zinc-300/20 w-full",children:(0,l.jsx)(p,{data:e,nivel:"".concat(t)})})),(0,l.jsx)("div",{className:"flex w-full",children:(0,l.jsx)(v.Z,{onClick:()=>{let e=[...t];e.push({name:"",Mode:"Add"}),a(e)},children:(0,l.jsx)(c,{})})})]})},f=()=>{let{categoriesList:e}=(0,n.b)(),[t,a]=(0,i.useState)([]);return(0,i.useEffect)(()=>{a([...e].filter(e=>!(null==e?void 0:e.parent)))},[e]),(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(x,{categories:t,setCategories:a})})},m=a(606),p=a(6463),g=()=>{let{isAuthenticated:e}=(0,m.a)(),t=(0,p.useRouter)();return e||t.push("/login"),(0,l.jsx)("div",{className:" h-full w-full flex items-center",children:(0,l.jsx)(f,{})})}},8254:function(e,t,a){"use strict";var l=a(8472),n=a(2649);let i=l.Z.create({baseURL:"http://localhost:8000"});i.interceptors.request.use(e=>{let t=n.Z.get("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),t.Z=i}},function(e){e.O(0,[355,576,434,376,971,23,744],function(){return e(e.s=3830)}),_N_E=e.O()}]);